javascript:(function(){ // 1
try{ // 2
var old=document.getElementById('ssm_wrap');if(old)old.remove(); // 3
var oldStyle=document.getElementById('ssm_style');if(oldStyle)oldStyle.remove(); // 4
var css="#ssm_wrap{position:fixed;inset:1%;z-index:2147483647;background:#0b0f14;color:#e6edf3;border:1px solid #233041;border-radius:10px;display:flex;flex-direction:column;font:12px/1.5 ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;box-shadow:0 10px 34px rgba(0,0,0,.45);transition:inset .2s}#ssm_head{display:flex;gap:12px;align-items:center;padding:10px 12px;border-bottom:1px solid #233041;user-select:none}#ssm_tabs{display:flex;gap:8px;padding:8px 12px 8px 0;border-bottom:1px solid #233041;flex-wrap:wrap}#ssm_body{flex:1 1 0%;min-height:500px;min-width:800px;display:flex;overflow:hidden}#ssm_side{width:280px;border-right:1px solid #233041;padding:10px;overflow:auto;transition:width .2s}#ssm_main{flex:1 1 0%;overflow:auto;padding:12px;white-space:pre}#ssm_btn{background:#17202b;color:#e6edf3;border:1px solid #2b3a4a;border-radius:6px;padding:6px 10px;cursor:pointer;margin-right:6px;transition:.1s}#ssm_btn:hover{background:#1c2733}#ssm_graph{flex:1 1 0%;overflow:hidden;padding:0;min-width:400px;min-height:400px}#ssm_canvas{width:100%;height:100%;display:block;background:#0b0f14;min-width:400px;min-height:400px;}#ssm_badge{display:inline-block;background:#17202b;border:1px solid #2b3a4a;border-radius:4px;padding:0 6px;margin:0 3px}.ssm_link{color:#9cdcfe}.ssm_small{opacity:.7}.ssm_kv{display:block;margin-bottom:6px}.ssm_tag{display:inline-block;border:1px solid #2b3a4a;background:#111827;color:#cbd5e1;border-radius:4px;padding:1px 6px;margin:2px 3px}"; // 5
var style=document.createElement('style');style.id='ssm_style';style.textContent=css;document.documentElement.appendChild(style); // 6
var D=document,W=window,now=new Date(),SRC=location.href,UA=navigator.userAgent,curHost=location.hostname.replace(/^www\./,''); // 7
function isShortenerHost(h){return/^(t.co|bit.ly|tinyurl.com|is.gd|cutt.ly|ow.ly|s.id|goo.gl|buff.ly|lnkd.in|adb.ly|rebrand.ly|v.gd|clck.ru|vk.cc)$/i.test(h);} // 8
function isSuspiciousTLD(h){return /\.(xyz|top|icu|cn|ru|rest|work|club|best|support|casa|loan|click|gq|cf|ml|tk|link|cfd|zip|mov|buzz|cam|monster|quest|beauty|hair|men|lol|review|country|gdn|kim|download|racing|stream|fit|mom|bar|host|party|date|faith|science|surf|site|online|shop|lol)$/i.test(h);} // 9
function hasCyrLatMix(s){return/[A-Za-z]/.test(s)&&/[А-Яа-яЁё]/.test(s);} // 10
function isIDN(h){return/xn--/i.test(h);} // 11
var SUS_PATH=/(login|verify|wallet|bonus|promo|airdrop|claim|giveaway|prize|auth|signin|account|recovery|seed|mnemonic|withdraw|payout|investment|broker|crypto|binance|bybit|okx|pass|gift|lottery|casino|bet)\b/i; // 12
var SUS_PARAM=/\b(sum|amount|wallet|addr|address|seed|mnemonic|key|private|bonus|promo|ref|aff|utm_|tracking|click|cid|gclid|fbclid|ysclid|yclid|msclkid)\b/i; // 13
function csvEsc(s){return'"'+String(s??'').replace(/"/g,'""')+'"';} // 14
function safeURL(u){try{return new URL(u,location.href)}catch(e){return null}} // 15
var records=[],seen=new Set(); // 16
function pushURL(url,meta){ // 17
  var u=safeURL(url);if(!u)return; // 18
  var host=u.hostname.replace(/^www\./,''),key=u.href+'|'+(meta.text||''); // 19
  if(seen.has(key))return; seen.add(key); // 20
  var params=[...u.searchParams.entries()]; // 21
  var utm=params.filter(([k])=>/^utm_/i.test(k)).map(x=>x[0]); // 22
  var aff=params.filter(([k])=>/(^|)(ref|aff|partner|pid|subid|affiliate)(|$)/i.test(k)).map(x=>x); // 23
  var trackers=params.filter(([k])=>/(gclid|fbclid|ysclid|yclid|msclkid|cid|clid)/i.test(k)).map(x=>x); // 24
  var suspPath=SUS_PATH.test(u.pathname),suspParam=SUS_PARAM.test(u.search),shortener=isShortenerHost(host),tldSusp=isSuspiciousTLD(host),idn=isIDN(host),mixed=hasCyrLatMix(host),suspicion=(shortener?2:0)+(tldSusp?2:0)+(idn?1:0)+(mixed?1:0)+(suspPath?2:0)+(suspParam?1:0)+((meta.rel||'').includes('sponsored')?1:0); // 25
  records.push({source:SRC,url:u.href,host,pathname:u.pathname||'/',is_external:host!==curHost,rel:meta.rel||'',attr:meta.attr||'',text_anchor:(meta.text||'').slice(0,160),utm_keys:[...new Set(utm)],aff_keys:[...new Set(aff)],tracker_keys:[...new Set(trackers)],shortener,has_susp_path:suspPath,has_susp_param:suspParam,suspicious_tld:tldSusp,idn,host_cyrlat_mix:mixed,suspicion_score:suspicion}); // 26
} // 27
[...D.querySelectorAll('a[href]')].forEach(a=>{var href=a.getAttribute('href');if(!href)return;if(/^javascript:|^mailto:|^tel:|^#/.test(href))return;pushURL(href,{text:a.textContent||'',rel:(a.getAttribute('rel')||'').toLowerCase(),attr:'href'});}); // 28
[...D.querySelectorAll('[onclick]')].forEach(el=>{var s=String(el.getAttribute('onclick')||'');var m=[...s.matchAll(/(?:https?:\/\/|\/)[^'" ]+/g)].map(x=>x[0]);m.slice(0,3).forEach(u=>pushURL(u,{text:el.textContent||'',attr:'onclick'}));}); // 29
[...D.querySelectorAll('[data-href],[data-url],[data-link]')].forEach(el=>{var u=el.getAttribute('data-href')||el.getAttribute('data-url')||el.getAttribute('data-link');if(u)pushURL(u,{text:el.textContent||'',attr:'data-'});}); // 30
function getMetaRefresh(){var metas=D.querySelectorAll('meta[http-equiv]');for(var i=0;i<metas.length;i++)if((metas[i].getAttribute('http-equiv')||'').toLowerCase()==='refresh')return metas[i];return null;} // 31
var metaRefresh=getMetaRefresh(); // 32
if(metaRefresh){var c=metaRefresh.getAttribute('content')||'';var m=c.match(/url\s*=\s*([^;]+)/i);if(m)pushURL(m[1].trim(),{attr:'meta-refresh'});} // 33
var canon=Array.from(D.getElementsByTagName('link')).find(l=>(l.getAttribute('rel')||'').toLowerCase()=="canonical"); // 34
if(canon&&canon.href)pushURL(canon.href,{attr:'canonical'}); // 35
var ogu=Array.from(D.getElementsByTagName('meta')).find(m=>(m.getAttribute('property')||'').toLowerCase()=="og:url"); // 36
if(ogu&&ogu.content)pushURL(ogu.content,{attr:'og:url'}); // 37
var byHost={},hostRows=Object.entries(records.reduce(function(all, r){ // 38
  var h=r.host,b=all[h]=all[h]||{count:0,external:0,shorteners:0,paths:new Set(),utm:new Set(),aff:new Set(),trackers:new Set(),max_score:0,flags:new Set(),samples:[]}; // 39
  b.count++;if(r.is_external)b.external++;if(r.shortener)b.shorteners++; // 40
  r.utm_keys.forEach(k=>b.utm.add(k));r.aff_keys.forEach(k=>b.aff.add(k));r.tracker_keys.forEach(k=>b.trackers.add(k)); // 41
  b.paths.add(r.pathname);b.max_score=Math.max(b.max_score,r.suspicion_score); // 42
  if(r.suspicious_tld)b.flags.add('tld');if(r.idn)b.flags.add('idn');if(r.host_cyrlat_mix)b.flags.add('cyrlat'); // 43
  if(r.has_susp_path)b.flags.add('path');if(r.has_susp_param)b.flags.add('param');if(r.shortener)b.flags.add('shortener'); // 44
  if(b.samples.length<3)b.samples.push(r.url);return all; // 45
},{})).map(([h,v])=>({host:h,count:v.count,external:v.external,shorteners:v.shorteners,unique_paths:[...v.paths].slice(0,6),utm_keys:[...v.utm],aff_keys:[...v.aff],tracker_keys:[...v.trackers],max_suspicion_score:v.max_score,flags:[...v.flags],sample:v.samples.join('|')})).sort((a,b)=>b.max_suspicion_score-a.max_suspicion_score||b.external-a.external||b.count-a.count); // 46
var csvHosts=['host,count,external,shorteners,max_suspicion_score,flags,utm_keys,aff_keys,tracker_keys,unique_paths,sample'] // 47
.concat(hostRows.map(r=>[r.host,r.count,r.external,r.shorteners,r.max_suspicion_score,r.flags.join('|'),r.utm_keys.join('|'),r.aff_keys.join('|'),r.tracker_keys.join('|'),r.unique_paths.join('|'),r.sample].map(csvEsc).join(','))).join('\n'); // 48
var csvLinks=['source,url,host,pathname,is_external,rel,attr,text_anchor,utm_keys,aff_keys,tracker_keys,shortener,has_susp_path,has_susp_param,suspicious_tld,idn,host_cyrlat_mix,suspicion_score'] // 49
.concat(records.map(r=>[r.source,r.url,r.host,r.pathname,r.is_external,r.rel,r.attr,r.text_anchor,r.utm_keys.join('|'),r.aff_keys.join('|'),r.tracker_keys.join('|'),r.shortener,r.has_susp_path,r.has_susp_param,r.suspicious_tld,r.idn,r.host_cyrlat_mix,r.suspicion_score].map(csvEsc).join(','))).join('\n'); // 50
var snapshot={meta:{generated_at:now.toISOString(),source:SRC,user_agent:UA,total_links:records.length,total_hosts:hostRows.length},summary:hostRows,links:records}; // 51
var wrap=D.createElement('div');wrap.id='ssm_wrap'; // 52
var head=D.createElement('div');head.id='ssm_head'; // 53
head.innerHTML='<strong>Scam Surface Mapper — Advanced</strong> <span style="margin-left:10px;font-weight:normal" class="ssm_small"> <a href="https://github.com/paulpogoda" target="_blank" style="color:#75a4da;font-weight:normal;">Created by Pavel Bannikov</a> </span><span class="ssm_small" style="margin-left:10px">links: '+records.length+', hosts: '+hostRows.length+'</span><span class="ssm_small" style="margin-left:auto">'+now.toISOString()+'</span>'; // 54
var closeBtn=D.createElement('button');closeBtn.textContent='Close ✕';closeBtn.type='button';closeBtn.id='ssm_btn';closeBtn.style.marginLeft='10px';closeBtn.onclick=function(){wrap.remove();}; // 55
var fsOn=false,fsBtn=document.createElement('button');fsBtn.textContent="Fullscreen";fsBtn.id='ssm_btn';fsBtn.style.marginLeft='10px';fsBtn.onclick=function(){fsOn=!fsOn;wrap.style.inset=fsOn?'0':'1%';fsBtn.textContent=fsOn?"Window":"Fullscreen";resizeCanvas();drawGraph();}; // 56
head.appendChild(closeBtn);head.appendChild(fsBtn); // 57
var tabs=D.createElement('div');tabs.id='ssm_tabs'; // 58
function btn(label,fn){var b=D.createElement('button');b.id='ssm_btn';b.textContent=label;b.onclick=fn;return b;} // 59
var bodyBox=D.createElement('div');bodyBox.id='ssm_body'; // 60
var side=D.createElement('div');side.id='ssm_side'; // 61
var main=D.createElement('div');main.id='ssm_main'; // 62
var graphBox=D.createElement('div');graphBox.id='ssm_graph';graphBox.style.display='none'; // 63
var canvas=D.createElement('canvas');canvas.id='ssm_canvas';graphBox.appendChild(canvas); // 64
let current='summary'; // 65
function renderSummary(){var lines=['Host Summary (risk descending)',''];for(var i=0;i<hostRows.length;i++){var r=hostRows[i];lines.push(r.host+' [links:'+r.count+' ext:'+r.external+' short:'+r.shorteners+'] score:'+r.max_suspicion_score+' flags:'+(r.flags.join('|')||'-'));if(r.unique_paths.length)lines.push(' paths: '+r.unique_paths.join(' '));if(r.sample)lines.push(' sample: '+r.sample);lines.push('');}main.textContent=lines.join('\n');} // 66
function renderLinks(){var lines=['Raw Links',''];for(var i=0;i<records.length;i++){var r=records[i];lines.push(r.url);lines.push(' host:'+r.host+' ext:'+r.is_external+' short:'+r.shortener+' score:'+r.suspicion_score);var ks=[];if(r.utm_keys.length)ks.push('utm='+r.utm_keys.join('|'));if(r.aff_keys.length)ks.push('aff='+r.aff_keys.join('|'));if(r.tracker_keys.length)ks.push('trk='+r.tracker_keys.join('|'));if(ks.length)lines.push(' '+ks.join(' '));if(r.text_anchor)lines.push(' txt:'+r.text_anchor);if(r.rel||r.attr)lines.push(' rel:'+(r.rel||'-')+' attr:'+(r.attr||'-'));lines.push('');}main.textContent=lines.join('\n');} // 67
function download(name,content,type){var blob=new Blob([content],{type:type||'text/plain;charset=utf-8'}),url=URL.createObjectURL(blob),a=D.createElement('a');a.href=url;a.download=name;D.body.appendChild(a);a.click();setTimeout(function(){URL.revokeObjectURL(url);a.remove();},200);} // 68
function copy(text){if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(text).catch(function(){alert('Clipboard error')});else alert('Clipboard API not available');} // 69
function openUrl(u){W.open(u,'_blank')} // 70
function sideRender(){side.innerHTML=''; // 71
var h1=D.createElement('div');h1.className='ssm_kv';h1.textContent='Actions';side.appendChild(h1); // 72
var actions=D.createElement('div'); // 73
[{label:'Copy JSON',on:()=>copy(JSON.stringify(snapshot,null,2))},{label:'Download hosts.csv',on:()=>download('scam_hosts.csv',csvHosts)},{label:'Download links.csv',on:()=>download('scam_links.csv',csvLinks)},{label:'Download snapshot.json',on:()=>download('scam_snapshot.json',JSON.stringify(snapshot,null,2),'application/json')},{label:'Save graph.png',on:()=>downloadCanvas()},{label:'Close window',on:()=>wrap.remove()}].forEach(a=>{var b=btn(a.label,a.on);b.style.display='block';b.style.margin='4px 0';actions.appendChild(b);});side.appendChild(actions); // 74
var h2=D.createElement('div');h2.className='ssm_kv';h2.textContent='Quick Filters (highlight)';side.appendChild(h2); // 75
var tags=D.createElement('div');[['shortener',r=>r.shortener],['tld',r=>r.suspicious_tld],['idn',r=>r.idn],['cyrlat',r=>r.host_cyrlat_mix],['param',r=>r.has_susp_param],['path',r=>r.has_susp_path]].forEach(([name,fn])=>{var c=records.filter(fn).length,span=D.createElement('span');span.className='ssm_tag';span.textContent=name+': '+c;tags.appendChild(span);});side.appendChild(tags); // 76
var h3=D.createElement('div');h3.className='ssm_kv';h3.textContent='Checks (right-click on graph)';side.appendChild(h3); // 77
var help=D.createElement('div');help.className='ssm_small';help.innerHTML="In the graph: right-click a node or edge to open urlscan or SecurityTrails. You are free to move graph blocks with your mouse/touchpad";side.appendChild(help);} // 78
var tSummary=btn('Summary',()=>{current='summary';graphBox.style.display='none';main.style.display='block';renderSummary()}); // 79
var tLinks=btn('Raw Links',()=>{current='links';graphBox.style.display='none';main.style.display='block';renderLinks()}); // 80
var tGraph=btn('Graph',()=>{current='graph';main.style.display='none';graphBox.style.display='flex';resizeCanvas();drawGraph();}); // 81
tabs.append(tSummary,tLinks,tGraph); // 82
var nodes=[],edges=[],idOf={},nid=0;function addNode(key,obj){if(idOf[key]!=null)return idOf[key];idOf[key]=nid;nodes.push(Object.assign({id:nid},obj));return nid++} // 83
var root=addNode('ROOT',{type:'root',label:curHost,score:0}); // 84
hostRows.forEach(h=>{ // 85
  var hid=addNode('H|'+h.host,{type:'host',label:h.host,score:h.max_suspicion_score,flags:h.flags}); // 86
  edges.push({from:root,to:hid,type:'src-host'}); // 87
}); // 88
var cw,ch,ctx,DPR=W.devicePixelRatio||1; // 89
function resizeCanvas(){var r=graphBox.getBoundingClientRect();cw=Math.max(300,Math.floor(r.width));ch=Math.max(260,Math.floor(r.height));canvas.width=cw*DPR;canvas.height=ch*DPR;canvas.style.width=cw+'px';canvas.style.height=ch+'px';ctx=canvas.getContext('2d');ctx.setTransform(DPR,0,0,DPR,0,0);} // 90
function rand(min,max){return min+Math.random()*(max-min);} // 91
var pos=new Map(),vel=new Map(); // 92
function initPositions(){nodes.forEach(n=>{if(n.type==='root'){pos.set(n,{x:cw*0.12,y:ch*0.5});vel.set(n,{x:0,y:0});}else if(n.type==='host'){pos.set(n,{x:rand(cw*0.28,cw*0.90),y:rand(40,ch-40)});vel.set(n,{x:0,y:0});}});} // 93
function stepLayout(iters){iters=iters||200;for(var k=0;k<iters;k++){for(var i=0;i<nodes.length;i++){for(var j=i+1;j<nodes.length;j++){var a=nodes[i],b=nodes[j],pa=pos.get(a),pb=pos.get(b),dx=pa.x-pb.x,dy=pa.y-pb.y,d2=dx*dx+dy*dy+0.01,f=2000/d2;dx/=Math.sqrt(d2);dy/=Math.sqrt(d2);vel.get(a).x+=dx*f;vel.get(a).y+=dy*f;vel.get(b).x-=dx*f;vel.get(b).y-=dy*f;}}edges.forEach(e=>{var a=nodes[e.from],b=nodes[e.to],pa=pos.get(a),pb=pos.get(b),dx=pb.x-pa.x,dy=pb.y-pa.y,dist=Math.sqrt(dx*dx+dy*dy)||1,kspr=0.02,desired=180,f=(dist-desired)*kspr;dx/=dist;dy/=dist;vel.get(a).x+=dx*f;vel.get(a).y+=dy*f;vel.get(b).x-=dx*f;vel.get(b).y-=dy*f;});nodes.forEach(n=>{var v=vel.get(n),p=pos.get(n);p.x+=v.x;p.y+=v.y;v.x*=0.85;v.y*=0.85;p.x=Math.max(40,Math.min(cw-40,p.x));p.y=Math.max(30,Math.min(ch-30,p.y));});}} // 94
function drawRoundedRect(x,y,w,h,r){ctx.beginPath();ctx.moveTo(x+r,y);ctx.arcTo(x+w,y,x+w,y+h,r);ctx.arcTo(x+w,y+h,x,y+h,r);ctx.arcTo(x,y+h,x,y,r);ctx.arcTo(x,y,x+w,y,r);ctx.closePath();} // 95
function colorFor(n){if(n.type==='root')return'#9cdcfe';if(n.type==='host')return(n.score>=4?'#ff6b6b':n.score>=2?'#ffb86c':'#8be9fd');} // 96
function drawGraph(){resizeCanvas();ctx.clearRect(0,0,cw,ch);ctx.lineWidth=1;ctx.strokeStyle='rgba(148,163,184,.45)';edges.forEach(e=>{var a=nodes[e.from],b=nodes[e.to],pa=pos.get(a),pb=pos.get(b);ctx.beginPath();ctx.moveTo(pa.x,pa.y);ctx.lineTo(pb.x,pb.y);ctx.stroke();});nodes.forEach(n=>{var p=pos.get(n),tx=(n.label||'').slice(0,24);ctx.font='12px ui-monospace';var tw=Math.min(300,Math.max(60,ctx.measureText(tx).width+18)),th=24,x=p.x-tw/2,y=p.y-th/2;drawRoundedRect(x,y,tw,th,6);ctx.fillStyle=colorFor(n);ctx.fill();ctx.strokeStyle='rgba(35,48,65,.9)';ctx.stroke();ctx.fillStyle='#0b0f14';ctx.fillText(tx,x+9,y+16);});} // 97
function nodeAt(mx,my){for(var i=nodes.length-1;i>=0;i--){var n=nodes[i],p=pos.get(n);ctx.font='12px ui-monospace';var tw=Math.min(300,Math.max(60,ctx.measureText((n.label||'').slice(0,24)).width+18)),th=24,x=p.x-tw/2,y=p.y-th/2;if(mx>=x&&mx<=x+tw&&my>=y&&my<=y+th)return n;}return null;} // 98
let dragging=null,dragOff=null; // 99
canvas.addEventListener('mousedown',e=>{var r=canvas.getBoundingClientRect(),x=e.clientX-r.left,y=e.clientY-r.top,n=nodeAt(x,y);if(n){dragging=n;var p=pos.get(n);dragOff={dx:x-p.x,dy:y-p.y};}}); // 100
W.addEventListener('mouseup',()=>{dragging=null;}); // 101
W.addEventListener('mousemove',e=>{if(!dragging)return;var r=canvas.getBoundingClientRect(),x=e.clientX-r.left,y=e.clientY-r.top,p=pos.get(dragging);p.x=x-dragOff.dx;p.y=y-dragOff.dy;drawGraph();}); // 102
var menu=D.createElement('div');menu.style='position:fixed;z-index:2147483647;background:#111827;color:#e5e7eb;border:1px solid #2b3a4a;border-radius:6px;display:none;min-width:220px;box-shadow:0 8px 22px rgba(0,0,0,.4)'; // 103
function showMenu(x,y,items){menu.innerHTML='';items.forEach(it=>{var d=D.createElement('div');d.textContent=it.label;d.style='padding:8px 10px;cursor:pointer;border-bottom:1px solid #1f2937';d.onmouseenter=()=>d.style.background='#1f2937';d.onmouseleave=()=>d.style.background='';d.onclick=()=>{menu.style.display='none';it.on();};menu.appendChild(d);});var last=menu.lastChild;if(last)last.style.borderBottom='none';menu.style.left=x+'px';menu.style.top=y+'px';menu.style.display='block';} // 104
graphBox.appendChild(menu); // 105
canvas.addEventListener('contextmenu',e=>{e.preventDefault();var r=canvas.getBoundingClientRect(),x=e.clientX-r.left,y=e.clientY-r.top,n=nodeAt(x,y); // 106
if(n){ // 107
  if(n.type==='host'){ // 108
    var domain=n.label; // 109
    showMenu(e.clientX,e.clientY,[ // 110
      {label:'SecurityTrails: Domain Overview',on:()=>openUrl('https://securitytrails.com/domain/'+encodeURIComponent(domain))}, // 111
      {label:'urlscan.io: Search domain',on:()=>openUrl('https://urlscan.io/search/#domain:'+encodeURIComponent(domain))}, // 112
      {label:'urlscan.io: Latest scans',on:()=>openUrl('https://urlscan.io/domain/'+encodeURIComponent(domain))} // 113
    ]); // 114
  }else if(n.type==='root'){ // 115
    showMenu(e.clientX,e.clientY,[ // 116
      {label:'Open Source',on:()=>openUrl(SRC)}, // 117
      {label:'urlscan.io: Search domain (source)',on:()=>openUrl('https://urlscan.io/search/#domain:'+encodeURIComponent(curHost))}, // 118
      {label:'SecurityTrails: Source Domain',on:()=>openUrl('https://securitytrails.com/domain/'+encodeURIComponent(curHost))} // 119
    ]); // 120
  } // 121
}}); // 122
W.addEventListener('click',()=>{menu.style.display='none';}); // 123
resizeCanvas();initPositions();stepLayout(200);drawGraph(); // 124
function downloadCanvas(){var tmp=D.createElement('canvas');tmp.width=canvas.width;tmp.height=canvas.height;var tctx=tmp.getContext('2d');tctx.drawImage(canvas,0,0);tmp.toBlob(b=>{var url=URL.createObjectURL(b),a=D.createElement('a');a.href=url;a.download='scam_graph.png';D.body.appendChild(a);a.click();setTimeout(()=>{URL.revokeObjectURL(url);a.remove();},200);});} // 125
renderSummary();sideRender(); // 126
bodyBox.appendChild(side);bodyBox.appendChild(main);bodyBox.appendChild(graphBox); // 127
wrap.appendChild(head);wrap.appendChild(tabs);wrap.appendChild(bodyBox);D.body.appendChild(wrap); // 128
function onResize(){if(current==='graph'){resizeCanvas();drawGraph();}}W.addEventListener('resize',onResize); // 129
if(hostRows.length>0){current='graph';main.style.display='none';graphBox.style.display='flex';drawGraph();} // 130
}catch(err){alert('SSM advanced error: '+(err&&err.message||err));} // 131
})(); // 132
